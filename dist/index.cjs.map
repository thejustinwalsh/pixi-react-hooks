{"version":3,"sources":["/Users/tjw/Developer/pixi-react-hooks/dist/index.cjs","../src/useAssets.ts","../src/useAssetBundle.ts","../src/useAssetManifest.ts"],"names":["useRef","useState","useEffect","isLoaded"],"mappings":"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","file":"/Users/tjw/Developer/pixi-react-hooks/dist/index.cjs","sourcesContent":[null,"import {useEffect, useRef, useState} from 'react';\nimport {isLoaded, load, resolve} from './utils';\n\nimport type {UnresolvedAsset} from 'pixi.js';\nimport type {AssetState, AssetUrl, HookState} from './types';\nimport {useAssetCache} from './useAssetCache';\n\nexport function useAssets<T>(urls: string | UnresolvedAsset): AssetState<T | undefined>;\nexport function useAssets<T>(urls: string[] | UnresolvedAsset[]): AssetState<Record<string, T>>;\n\nexport function useAssets<T>(urls: AssetUrl) {\n  const cache = useAssetCache<T, AssetUrl>({urls, isLoaded, load, resolve});\n  const sync = useRef(new WeakSet<Promise<unknown>>());\n  const [state, setState] = useState<HookState<T | Record<string, T>>>(() => ({\n    data: cache.data,\n    error: null,\n  }));\n\n  useEffect(() => {\n    if (cache.data === null && !sync.current.has(cache.promise)) {\n      cache.promise\n        .then(data => {\n          if (sync.current.has(cache.promise)) {\n            setState({\n              data,\n              error: null,\n            });\n          }\n          return data;\n        })\n        .catch(error => {\n          if (sync.current.has(cache.promise)) {\n            setState({\n              data: null,\n              error,\n            });\n          }\n        });\n    }\n    sync.current = new WeakSet([cache.promise]);\n  }, [cache.promise, cache.data]);\n\n  if (state.error) {\n    return {\n      status: 'error',\n      isLoaded: false,\n      data: null,\n      error: state.error,\n    };\n  }\n  if (state.data) {\n    return {\n      status: 'loaded',\n      isLoaded: true,\n      data: state.data,\n      error: null,\n    };\n  }\n  return {\n    status: 'pending',\n    isLoaded: false,\n    data: null,\n    error: null,\n  };\n}\n","import {useEffect, useRef, useState} from 'react';\nimport {useAssetCache} from './hooks/useAssetCache';\nimport {isBundleLoaded, loadBundle, resolveBundle} from './utils';\n\nimport type {AssetState, HookState} from './types';\n\nexport function useAssetBundle<T extends Record<string, unknown>>(\n  bundles: string | string[],\n): AssetState<T> {\n  const cache = useAssetCache<T, string | string[]>({\n    urls: bundles,\n    isLoaded: isBundleLoaded,\n    load: loadBundle,\n    resolve: resolveBundle,\n  });\n  const sync = useRef(new WeakSet<Promise<unknown>>());\n  const [state, setState] = useState<HookState<T>>(() => ({\n    data: cache.data,\n    error: null,\n  }));\n\n  useEffect(() => {\n    if (cache.data === null && !sync.current.has(cache.promise)) {\n      cache.promise\n        .then(data => {\n          if (sync.current.has(cache.promise)) {\n            setState({\n              data,\n              error: null,\n            });\n          }\n          return data;\n        })\n        .catch(error => {\n          if (sync.current.has(cache.promise)) {\n            setState({\n              data: null,\n              error,\n            });\n          }\n        });\n    }\n    sync.current = new WeakSet([cache.promise]);\n  }, [cache.promise, cache.data]);\n\n  if (state.error) {\n    return {\n      status: 'error',\n      isLoaded: false,\n      data: null,\n      error: state.error,\n    };\n  }\n  if (state.data) {\n    return {\n      status: 'loaded',\n      isLoaded: true,\n      data: state.data,\n      error: null,\n    };\n  }\n  return {\n    status: 'pending',\n    isLoaded: false,\n    data: null,\n    error: null,\n  };\n}\n","import {Assets, AssetsManifest} from 'pixi.js';\nimport {useEffect, useState} from 'react';\nimport {useWarnOnRemount} from './hooks/useWarnOnRemount';\n\ntype AssetManifestState = {\n  isLoaded: boolean;\n  thenable: Promise<void>;\n};\n\nexport function useAssetManifest(\n  manifest: AssetsManifest,\n  bundles: string[] = [],\n  options: Omit<Parameters<typeof Assets.init>[0], 'manifest'> = {},\n) {\n  useWarnOnRemount(useAssetManifest);\n  const [{isLoaded, thenable}, setState] = useState<AssetManifestState>(() => ({\n    isLoaded: false,\n    thenable: Assets.init({\n      ...options,\n      manifest,\n    }).then(() => {\n      Assets.backgroundLoadBundle(\n        bundles.length > 0 ? bundles : manifest.bundles.map(bundle => bundle.name),\n      );\n    }),\n  }));\n\n  useEffect(() => {\n    thenable.then(() => setState(s => ({...s, isLoaded: true})));\n  }, [thenable]);\n\n  return {isLoaded};\n}\n"]}