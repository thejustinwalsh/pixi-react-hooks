{"version":3,"sources":["../src/useAssets.ts","../src/useAssetBundle.ts","../src/useAssetManifest.ts"],"sourcesContent":["import {useEffect, useRef, useState} from 'react';\nimport {isLoaded, load, resolve} from './utils';\n\nimport type {UnresolvedAsset} from 'pixi.js';\nimport type {AssetState, AssetUrl, HookState} from './types';\nimport {useAssetCache} from './useAssetCache';\n\nexport function useAssets<T>(urls: string | UnresolvedAsset): AssetState<T | undefined>;\nexport function useAssets<T>(urls: string[] | UnresolvedAsset[]): AssetState<Record<string, T>>;\n\nexport function useAssets<T>(urls: AssetUrl) {\n  const cache = useAssetCache<T, AssetUrl>({urls, isLoaded, load, resolve});\n  const sync = useRef(new WeakSet<Promise<unknown>>());\n  const [state, setState] = useState<HookState<T | Record<string, T>>>(() => ({\n    data: cache.data,\n    error: null,\n  }));\n\n  useEffect(() => {\n    if (cache.data === null && !sync.current.has(cache.promise)) {\n      cache.promise\n        .then(data => {\n          if (sync.current.has(cache.promise)) {\n            setState({\n              data,\n              error: null,\n            });\n          }\n          return data;\n        })\n        .catch(error => {\n          if (sync.current.has(cache.promise)) {\n            setState({\n              data: null,\n              error,\n            });\n          }\n        });\n    }\n    sync.current = new WeakSet([cache.promise]);\n  }, [cache.promise, cache.data]);\n\n  if (state.error) {\n    return {\n      status: 'error',\n      isLoaded: false,\n      data: null,\n      error: state.error,\n    };\n  }\n  if (state.data) {\n    return {\n      status: 'loaded',\n      isLoaded: true,\n      data: state.data,\n      error: null,\n    };\n  }\n  return {\n    status: 'pending',\n    isLoaded: false,\n    data: null,\n    error: null,\n  };\n}\n","import {useEffect, useRef, useState} from 'react';\nimport {useAssetCache} from './hooks/useAssetCache';\nimport {isBundleLoaded, loadBundle, resolveBundle} from './utils';\n\nimport type {AssetState, HookState} from './types';\n\nexport function useAssetBundle<T extends Record<string, unknown>>(\n  bundles: string | string[],\n): AssetState<T> {\n  const cache = useAssetCache<T, string | string[]>({\n    urls: bundles,\n    isLoaded: isBundleLoaded,\n    load: loadBundle,\n    resolve: resolveBundle,\n  });\n  const sync = useRef(new WeakSet<Promise<unknown>>());\n  const [state, setState] = useState<HookState<T>>(() => ({\n    data: cache.data,\n    error: null,\n  }));\n\n  useEffect(() => {\n    if (cache.data === null && !sync.current.has(cache.promise)) {\n      cache.promise\n        .then(data => {\n          if (sync.current.has(cache.promise)) {\n            setState({\n              data,\n              error: null,\n            });\n          }\n          return data;\n        })\n        .catch(error => {\n          if (sync.current.has(cache.promise)) {\n            setState({\n              data: null,\n              error,\n            });\n          }\n        });\n    }\n    sync.current = new WeakSet([cache.promise]);\n  }, [cache.promise, cache.data]);\n\n  if (state.error) {\n    return {\n      status: 'error',\n      isLoaded: false,\n      data: null,\n      error: state.error,\n    };\n  }\n  if (state.data) {\n    return {\n      status: 'loaded',\n      isLoaded: true,\n      data: state.data,\n      error: null,\n    };\n  }\n  return {\n    status: 'pending',\n    isLoaded: false,\n    data: null,\n    error: null,\n  };\n}\n","import {Assets, AssetsManifest} from 'pixi.js';\nimport {useEffect, useState} from 'react';\nimport {useWarnOnRemount} from './hooks/useWarnOnRemount';\n\ntype AssetManifestState = {\n  isLoaded: boolean;\n  thenable: Promise<void>;\n};\n\nexport function useAssetManifest(\n  manifest: AssetsManifest,\n  bundles: string[] = [],\n  options: Omit<Parameters<typeof Assets.init>[0], 'manifest'> = {},\n) {\n  useWarnOnRemount(useAssetManifest);\n  const [{isLoaded, thenable}, setState] = useState<AssetManifestState>(() => ({\n    isLoaded: false,\n    thenable: Assets.init({\n      ...options,\n      manifest,\n    }).then(() => {\n      Assets.backgroundLoadBundle(\n        bundles.length > 0 ? bundles : manifest.bundles.map(bundle => bundle.name),\n      );\n    }),\n  }));\n\n  useEffect(() => {\n    thenable.then(() => setState(s => ({...s, isLoaded: true})));\n  }, [thenable]);\n\n  return {isLoaded};\n}\n"],"mappings":"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","names":["useEffect","useRef","useState","useRef","useState","useEffect","useEffect","useState","isLoaded","useState","useEffect"]}